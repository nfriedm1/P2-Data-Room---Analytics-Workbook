<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P2 Data Room | Technical Architecture & Data Engineering Deep-Dive</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500;600&family=Archivo+Black&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #0c0e14;
            --bg-primary: #12151f;
            --bg-secondary: #1a1e2e;
            --bg-elevated: #232838;
            --bg-card: rgba(26, 30, 46, 0.7);
            --accent-primary: #00d4aa;
            --accent-secondary: #00b4d8;
            --accent-tertiary: #7b61ff;
            --accent-warning: #ffb703;
            --accent-danger: #ff5a5a;
            --accent-success: #00d68f;
            --text-primary: #f0f4f8;
            --text-secondary: #a0aec0;
            --text-muted: #64748b;
            --text-code: #00d4aa;
            --border-subtle: rgba(255,255,255,0.06);
            --border-accent: rgba(0,212,170,0.3);
            --gradient-primary: linear-gradient(135deg, #00d4aa 0%, #00b4d8 50%, #7b61ff 100%);
            --gradient-dark: linear-gradient(180deg, #12151f 0%, #0c0e14 100%);
            --gradient-card: linear-gradient(145deg, rgba(35,40,56,0.8) 0%, rgba(26,30,46,0.6) 100%);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-deep);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }
        h1, h2, h3 { font-family: 'Archivo Black', 'IBM Plex Sans', sans-serif; letter-spacing: -0.02em; }
        code, .mono { font-family: 'IBM Plex Mono', monospace; }
        .app-container { display: flex; min-height: 100vh; }
        .sidebar {
            width: 320px;
            background: var(--gradient-dark);
            border-right: 1px solid var(--border-subtle);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
        }
        .sidebar-header {
            padding: 32px 24px;
            border-bottom: 1px solid var(--border-subtle);
        }
        .logo-container { display: flex; align-items: center; gap: 16px; margin-bottom: 8px; }
        .logo-icon {
            width: 52px; height: 52px;
            background: var(--gradient-primary);
            border-radius: 14px;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px; font-weight: bold;
            color: var(--bg-deep);
            box-shadow: 0 8px 32px rgba(0,212,170,0.3);
        }
        .logo-text {
            font-family: 'Archivo Black', sans-serif;
            font-size: 1.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .logo-subtitle {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-top: 4px;
        }
        .nav-section { padding: 24px 16px; }
        .nav-group { margin-bottom: 28px; }
        .nav-group-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 2.5px;
            color: var(--text-muted);
            padding: 0 12px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-group-label::after { content: ''; flex: 1; height: 1px; background: var(--border-subtle); }
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            margin: 4px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
            border: 1px solid transparent;
            position: relative;
        }
        .nav-item:hover {
            background: rgba(0,212,170,0.08);
            color: var(--text-primary);
            border-color: rgba(0,212,170,0.2);
        }
        .nav-item.active {
            background: rgba(0,212,170,0.12);
            color: var(--accent-primary);
            border-color: var(--accent-primary);
        }
        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0; top: 50%;
            transform: translateY(-50%);
            width: 3px; height: 60%;
            background: var(--accent-primary);
            border-radius: 0 2px 2px 0;
        }
        .nav-icon {
            width: 28px; height: 28px;
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; border-radius: 6px;
            background: rgba(255,255,255,0.03);
        }
        .nav-badge {
            font-size: 0.6rem;
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: auto;
            font-family: 'IBM Plex Mono', monospace;
            font-weight: 600;
        }
        .nav-badge.tech { background: rgba(0,212,170,0.2); color: var(--accent-primary); }
        .nav-badge.data { background: rgba(0,180,216,0.2); color: var(--accent-secondary); }
        .nav-badge.arch { background: rgba(123,97,255,0.2); color: var(--accent-tertiary); }
        .main-content { flex: 1; margin-left: 320px; min-height: 100vh; }
        .content-section {
            display: none;
            padding: 48px;
            max-width: 1400px;
            animation: fadeIn 0.4s ease;
        }
        .content-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .section-header { margin-bottom: 40px; }
        .section-tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--accent-primary);
            margin-bottom: 12px;
            padding: 6px 14px;
            background: rgba(0,212,170,0.1);
            border-radius: 20px;
            border: 1px solid rgba(0,212,170,0.2);
        }
        .section-title {
            font-size: 2.5rem;
            margin-bottom: 12px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .section-subtitle { font-size: 1.1rem; color: var(--text-secondary); max-width: 700px; }
        .card {
            background: var(--gradient-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 24px;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
        }
        .card:hover {
            border-color: var(--border-accent);
            transform: translateY(-2px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .card-header { display: flex; align-items: center; gap: 16px; margin-bottom: 20px; }
        .card-icon {
            width: 48px; height: 48px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 22px;
        }
        .card-icon.primary { background: rgba(0,212,170,0.15); }
        .card-icon.secondary { background: rgba(0,180,216,0.15); }
        .card-icon.tertiary { background: rgba(123,97,255,0.15); }
        .card-icon.warning { background: rgba(255,183,3,0.15); }
        .card-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 4px; }
        .card-subtitle { font-size: 0.8rem; color: var(--text-muted); }
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .metric-card {
            background: var(--gradient-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
        }
        .metric-card:hover { border-color: var(--border-accent); transform: translateY(-4px); }
        .metric-value {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 2.2rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }
        .metric-label { font-size: 0.85rem; color: var(--text-secondary); font-weight: 500; }
        .metric-sublabel { font-size: 0.7rem; color: var(--text-muted); margin-top: 4px; }
        .arch-diagram {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 32px;
            margin: 24px 0;
        }
        .arch-layer {
            display: flex;
            align-items: center;
            gap: 16px;
            margin: 16px 0;
            padding: 20px;
            background: rgba(255,255,255,0.02);
            border-radius: 12px;
            border-left: 4px solid var(--accent-primary);
        }
        .arch-layer.source { border-left-color: var(--accent-secondary); }
        .arch-layer.process { border-left-color: var(--accent-primary); }
        .arch-layer.validate { border-left-color: var(--accent-warning); }
        .arch-layer.output { border-left-color: var(--accent-tertiary); }
        .arch-layer-icon {
            width: 56px; height: 56px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px;
            background: rgba(255,255,255,0.05);
            flex-shrink: 0;
        }
        .arch-layer-content { flex: 1; }
        .arch-layer-title { font-weight: 700; font-size: 1rem; margin-bottom: 4px; }
        .arch-layer-desc { font-size: 0.85rem; color: var(--text-secondary); }
        .arch-components { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; }
        .arch-component {
            font-size: 0.7rem;
            padding: 4px 12px;
            background: rgba(0,212,170,0.1);
            border: 1px solid rgba(0,212,170,0.2);
            border-radius: 6px;
            color: var(--accent-primary);
            font-family: 'IBM Plex Mono', monospace;
        }
        .flow-arrow { text-align: center; color: var(--text-muted); font-size: 1.5rem; padding: 8px 0; }
        .data-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .data-table th {
            text-align: left;
            padding: 14px 16px;
            background: rgba(0,212,170,0.08);
            color: var(--accent-primary);
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid var(--border-subtle);
        }
        .data-table td {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border-subtle);
            color: var(--text-secondary);
        }
        .data-table tr:hover td { background: rgba(255,255,255,0.02); }
        .data-table .mono { color: var(--text-code); }
        .code-block {
            background: var(--bg-deep);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.8;
            overflow-x: auto;
            color: var(--text-secondary);
            white-space: pre-wrap;
        }
        .code-block .keyword { color: var(--accent-tertiary); }
        .code-block .function { color: var(--accent-secondary); }
        .code-block .string { color: var(--accent-primary); }
        .code-block .comment { color: var(--text-muted); font-style: italic; }
        .code-block .number { color: var(--accent-warning); }
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .badge.success { background: rgba(0,214,143,0.15); color: var(--accent-success); }
        .badge.warning { background: rgba(255,183,3,0.15); color: var(--accent-warning); }
        .badge.info { background: rgba(0,180,216,0.15); color: var(--accent-secondary); }
        .badge.primary { background: rgba(0,212,170,0.15); color: var(--accent-primary); }
        .sheet-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
        .sheet-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            transition: all 0.2s ease;
        }
        .sheet-card:hover { border-color: var(--accent-primary); }
        .sheet-card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
        .sheet-card-name { font-weight: 600; font-size: 0.9rem; display: flex; align-items: center; gap: 8px; }
        .sheet-card-layer {
            font-size: 0.6rem;
            padding: 3px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .sheet-card-layer.source { background: rgba(0,180,216,0.15); color: var(--accent-secondary); }
        .sheet-card-layer.process { background: rgba(0,212,170,0.15); color: var(--accent-primary); }
        .sheet-card-layer.output { background: rgba(123,97,255,0.15); color: var(--accent-tertiary); }
        .sheet-card-layer.config { background: rgba(255,183,3,0.15); color: var(--accent-warning); }
        .sheet-card-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; font-size: 0.75rem; }
        .sheet-stat { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid rgba(255,255,255,0.03); }
        .sheet-stat-label { color: var(--text-muted); }
        .sheet-stat-value { color: var(--text-primary); font-family: 'IBM Plex Mono', monospace; }
        .pipeline-container { display: flex; align-items: stretch; gap: 16px; padding: 24px 0; overflow-x: auto; }
        .pipeline-stage {
            flex: 1;
            min-width: 180px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
        }
        .pipeline-stage::after {
            content: '‚Üí';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-primary);
            font-size: 1.2rem;
            font-weight: bold;
        }
        .pipeline-stage:last-child::after { display: none; }
        .pipeline-stage-num {
            position: absolute;
            top: -10px;
            left: 16px;
            width: 24px; height: 24px;
            background: var(--accent-primary);
            color: var(--bg-deep);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
        }
        .pipeline-stage-title { font-weight: 700; font-size: 0.9rem; margin-bottom: 8px; margin-top: 8px; }
        .pipeline-stage-items { font-size: 0.75rem; color: var(--text-secondary); list-style: none; }
        .pipeline-stage-items li { padding: 4px 0; padding-left: 16px; position: relative; }
        .pipeline-stage-items li::before { content: '‚Ä¢'; position: absolute; left: 0; color: var(--accent-primary); }
        .erd-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; margin: 24px 0; }
        .erd-entity {
            background: var(--bg-secondary);
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .erd-entity:hover { border-color: var(--accent-primary); transform: scale(1.02); }
        .erd-entity-header {
            padding: 14px 18px;
            background: rgba(0,212,170,0.1);
            border-bottom: 1px solid var(--border-subtle);
            font-weight: 700;
            font-size: 0.9rem;
            display: flex; align-items: center; gap: 10px;
        }
        .erd-entity-header.source { background: rgba(0,180,216,0.1); }
        .erd-entity-header.process { background: rgba(0,212,170,0.1); }
        .erd-entity-header.output { background: rgba(123,97,255,0.1); }
        .erd-entity-body { padding: 14px 18px; }
        .erd-field {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 0;
            font-size: 0.75rem;
            border-bottom: 1px solid rgba(255,255,255,0.03);
        }
        .erd-field:last-child { border-bottom: none; }
        .erd-field-icon { width: 16px; font-size: 10px; color: var(--accent-primary); }
        .erd-field-name { font-family: 'IBM Plex Mono', monospace; color: var(--text-primary); }
        .erd-field-type { margin-left: auto; color: var(--text-muted); font-size: 0.65rem; }
        .dep-diagram {
            position: relative;
            padding: 40px;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin: 24px 0;
        }
        .dep-layer { display: flex; justify-content: center; gap: 20px; margin: 20px 0; flex-wrap: wrap; }
        .dep-node {
            background: var(--bg-elevated);
            border: 2px solid var(--border-subtle);
            border-radius: 10px;
            padding: 12px 18px;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s ease;
            text-align: center;
            min-width: 140px;
        }
        .dep-node:hover { border-color: var(--accent-primary); transform: translateY(-2px); }
        .dep-node.source { border-color: var(--accent-secondary); }
        .dep-node.process { border-color: var(--accent-primary); }
        .dep-node.output { border-color: var(--accent-tertiary); }
        .dep-connector { text-align: center; color: var(--text-muted); font-size: 1.2rem; padding: 8px 0; }
        @media (max-width: 1200px) {
            .grid-3 { grid-template-columns: repeat(2, 1fr); }
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
            .erd-container { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 900px) {
            .sidebar { width: 260px; }
            .main-content { margin-left: 260px; }
            .content-section { padding: 32px; }
            .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
            .erd-container { grid-template-columns: 1fr; }
        }
        @media print {
            .sidebar { display: none; }
            .main-content { margin-left: 0; }
            .content-section { display: block !important; page-break-after: always; }
        }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--bg-elevated); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(0,212,170,0.3); }
    </style>
</head>
<body>
    <div class="app-container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <div class="logo-icon">P2</div>
                    <div>
                        <div class="logo-text">DataRoom</div>
                        <div class="logo-subtitle">Technical Architecture</div>
                    </div>
                </div>
            </div>
            <div class="nav-section">
                <div class="nav-group">
                    <div class="nav-group-label">Overview</div>
                    <div class="nav-item active" onclick="showSection('overview')">
                        <div class="nav-icon">üèóÔ∏è</div>
                        <span>Executive Summary</span>
                    </div>
                    <div class="nav-item" onclick="showSection('metrics')">
                        <div class="nav-icon">üìä</div>
                        <span>System Metrics</span>
                        <span class="nav-badge tech">154K+</span>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-label">Architecture</div>
                    <div class="nav-item" onclick="showSection('system-arch')">
                        <div class="nav-icon">üî∑</div>
                        <span>Systems Architecture</span>
                        <span class="nav-badge arch">CORE</span>
                    </div>
                    <div class="nav-item" onclick="showSection('data-flow')">
                        <div class="nav-icon">üîÄ</div>
                        <span>Data Flow Pipeline</span>
                    </div>
                    <div class="nav-item" onclick="showSection('components')">
                        <div class="nav-icon">‚öôÔ∏è</div>
                        <span>Engine Components</span>
                        <span class="nav-badge data">14</span>
                    </div>
                    <div class="nav-item" onclick="showSection('lineage')">
                        <div class="nav-icon">üîó</div>
                        <span>Data Lineage</span>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-label">Data Engineering</div>
                    <div class="nav-item" onclick="showSection('erd')">
                        <div class="nav-icon">üìê</div>
                        <span>Entity Relationships</span>
                    </div>
                    <div class="nav-item" onclick="showSection('validation')">
                        <div class="nav-icon">‚úÖ</div>
                        <span>Validation Pipeline</span>
                    </div>
                    <div class="nav-item" onclick="showSection('business-rules')">
                        <div class="nav-icon">üìã</div>
                        <span>Business Rules Engine</span>
                    </div>
                    <div class="nav-item" onclick="showSection('sql-proxy')">
                        <div class="nav-icon">üóÑÔ∏è</div>
                        <span>SQL Schema Proxy</span>
                        <span class="nav-badge tech">DDL</span>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-label">Future State</div>
                    <div class="nav-item" onclick="showSection('blueprint')">
                        <div class="nav-icon">üöÄ</div>
                        <span>Enterprise Blueprint</span>
                    </div>
                    <div class="nav-item" onclick="showSection('value-stream')">
                        <div class="nav-icon">üìà</div>
                        <span>Value Stream Map</span>
                    </div>
                </div>
            </div>
        </nav>
        <main class="main-content">
            <!-- Section: Overview -->
            <section id="section-overview" class="content-section active">
                <div class="section-header">
                    <div class="section-tag">üìã Technical Documentation</div>
                    <h1 class="section-title">P2 Data Room & Analytics Engine</h1>
                    <p class="section-subtitle">Enterprise-grade loan portfolio analytics infrastructure implemented in Excel, serving as a complete blueprint for future database and data warehouse migration.</p>
                </div>
                <div class="grid-4" style="margin-bottom: 32px;">
                    <div class="metric-card">
                        <div class="metric-value">154,307</div>
                        <div class="metric-label">Total Data Points</div>
                        <div class="metric-sublabel">Values + Formulas</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">60,481</div>
                        <div class="metric-label">Formula Cells</div>
                        <div class="metric-sublabel">Automated Calculations</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">14</div>
                        <div class="metric-label">Engine Modules</div>
                        <div class="metric-sublabel">Interconnected Sheets</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">&lt;5 min</div>
                        <div class="metric-label">Monthly Execution</div>
                        <div class="metric-sublabel">vs. Hours Manual</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon primary">üéØ</div>
                        <div>
                            <div class="card-title">System Purpose & Capabilities</div>
                            <div class="card-subtitle">What this infrastructure delivers</div>
                        </div>
                    </div>
                    <div class="grid-2">
                        <div>
                            <h4 style="color: var(--accent-primary); margin-bottom: 12px; font-size: 0.9rem;">Core Functions</h4>
                            <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                                <li>‚úì Monthly DR Tape generation for investor reporting</li>
                                <li>‚úì Real-time loan status classification (Performing/Collections/DQ60+)</li>
                                <li>‚úì Automated UPB reconciliation with source data</li>
                                <li>‚úì 30/360 interest accrual calculations</li>
                                <li>‚úì Days Past Due (DPD) tracking & delinquency analysis</li>
                                <li>‚úì Historical metrics & trend analysis (12 months)</li>
                                <li>‚úì Multi-servicer data aggregation (Rogue + PorchPass)</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: var(--accent-secondary); margin-bottom: 12px; font-size: 0.9rem;">Technical Achievements</h4>
                            <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                                <li>‚úì Single-input period changes (Config ‚Üí All Sheets)</li>
                                <li>‚úì Automated validation flag generation</li>
                                <li>‚úì Cross-platform data matching (INDEX/MATCH)</li>
                                <li>‚úì Rule-based status determination engine</li>
                                <li>‚úì Exception handling & error detection</li>
                                <li>‚úì Complete audit trail via formula transparency</li>
                                <li>‚úì Scalable architecture (400 ‚Üí 10,000+ loans)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="grid-3">
                    <div class="card" style="border-left: 4px solid var(--accent-secondary);">
                        <h4 style="font-size: 1rem; margin-bottom: 16px;">üì• Data Sources</h4>
                        <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8;">
                            <li>‚Ä¢ Madison Portal (Servicer)</li>
                            <li>‚Ä¢ Rogue Transaction History</li>
                            <li>‚Ä¢ PorchPass Transaction History</li>
                            <li>‚Ä¢ P2 Origination Data</li>
                            <li>‚Ä¢ 17 New Fields Supplemental</li>
                        </ul>
                    </div>
                    <div class="card" style="border-left: 4px solid var(--accent-primary);">
                        <h4 style="font-size: 1rem; margin-bottom: 16px;">‚ö° Processing Engine</h4>
                        <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8;">
                            <li>‚Ä¢ Trial Balance Processor</li>
                            <li>‚Ä¢ Loan Sale Data Calculator</li>
                            <li>‚Ä¢ Historical Metrics Aggregator</li>
                            <li>‚Ä¢ Validation Rules Engine</li>
                            <li>‚Ä¢ Calendar Analysis Module</li>
                        </ul>
                    </div>
                    <div class="card" style="border-left: 4px solid var(--accent-tertiary);">
                        <h4 style="font-size: 1rem; margin-bottom: 16px;">üì§ Output Layers</h4>
                        <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8;">
                            <li>‚Ä¢ MAIC Analytics Dashboard</li>
                            <li>‚Ä¢ Servicing Dashboard</li>
                            <li>‚Ä¢ QA Dashboard</li>
                            <li>‚Ä¢ Visual Dashboard (Charts)</li>
                            <li>‚Ä¢ Loan Detail Viewer</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section: System Metrics -->
            <section id="section-metrics" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üìä Quantitative Analysis</div>
                    <h1 class="section-title">System Metrics & Statistics</h1>
                    <p class="section-subtitle">Comprehensive breakdown of the data infrastructure's scale, complexity, and processing capabilities.</p>
                </div>
                <div class="grid-4" style="margin-bottom: 32px;">
                    <div class="metric-card">
                        <div class="metric-value">93,826</div>
                        <div class="metric-label">Static Data Values</div>
                        <div class="metric-sublabel">Input/Reference Data</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">60,481</div>
                        <div class="metric-label">Formula Cells</div>
                        <div class="metric-sublabel">Calculated Fields</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">398</div>
                        <div class="metric-label">Active Loans</div>
                        <div class="metric-sublabel">November 2025</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">12</div>
                        <div class="metric-label">Months Historical</div>
                        <div class="metric-sublabel">Dec 2024 ‚Üí Nov 2025</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon secondary">üìê</div>
                        <div>
                            <div class="card-title">Formula Complexity Distribution</div>
                            <div class="card-subtitle">Analysis of calculation sophistication across the system</div>
                        </div>
                    </div>
                    <div class="grid-4">
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--accent-secondary);">5,186</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Simple (1 func)</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted);">11.6%</div>
                            <div style="height: 8px; background: var(--bg-elevated); border-radius: 4px; margin-top: 12px; overflow: hidden;">
                                <div style="height: 100%; width: 11.6%; background: var(--accent-secondary); border-radius: 4px;"></div>
                            </div>
                        </div>
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--accent-primary);">10,202</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Medium (2-3 func)</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted);">22.9%</div>
                            <div style="height: 8px; background: var(--bg-elevated); border-radius: 4px; margin-top: 12px; overflow: hidden;">
                                <div style="height: 100%; width: 22.9%; background: var(--accent-primary); border-radius: 4px;"></div>
                            </div>
                        </div>
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--accent-warning);">17,667</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Complex (4-6 func)</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted);">39.7%</div>
                            <div style="height: 8px; background: var(--bg-elevated); border-radius: 4px; margin-top: 12px; overflow: hidden;">
                                <div style="height: 100%; width: 39.7%; background: var(--accent-warning); border-radius: 4px;"></div>
                            </div>
                        </div>
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--accent-tertiary);">11,491</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Very Complex (7+)</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted);">25.8%</div>
                            <div style="height: 8px; background: var(--bg-elevated); border-radius: 4px; margin-top: 12px; overflow: hidden;">
                                <div style="height: 100%; width: 25.8%; background: var(--accent-tertiary); border-radius: 4px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon warning">üìã</div>
                        <div>
                            <div class="card-title">Module-by-Module Breakdown</div>
                            <div class="card-subtitle">Data distribution across all 14 engine components</div>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Module (Sheet)</th>
                                <th>Dimensions</th>
                                <th>Formulas</th>
                                <th>Values</th>
                                <th>Layer Type</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="mono">Trial Balance_Nov2025</td>
                                <td>400 √ó 68</td>
                                <td class="mono" style="color: var(--accent-primary);">22,742</td>
                                <td>2,454</td>
                                <td><span class="badge primary">PROCESSING</span></td>
                            </tr>
                            <tr>
                                <td class="mono">Loan Sale Data</td>
                                <td>432 √ó 74</td>
                                <td class="mono" style="color: var(--accent-primary);">14,334</td>
                                <td>8,839</td>
                                <td><span class="badge primary">PROCESSING</span></td>
                            </tr>
                            <tr>
                                <td class="mono">Rogue</td>
                                <td>3,274 √ó 17</td>
                                <td class="mono" style="color: var(--accent-secondary);">13,068</td>
                                <td>36,359</td>
                                <td><span class="badge info">SOURCE</span></td>
                            </tr>
                            <tr>
                                <td class="mono">PorchPass</td>
                                <td>2,768 √ó 17</td>
                                <td class="mono" style="color: var(--accent-secondary);">6,811</td>
                                <td>6,402</td>
                                <td><span class="badge info">SOURCE</span></td>
                            </tr>
                            <tr>
                                <td class="mono">P2 Originated Serviced</td>
                                <td>399 √ó 76</td>
                                <td class="mono">797</td>
                                <td>25,571</td>
                                <td><span class="badge info">SOURCE</span></td>
                            </tr>
                            <tr>
                                <td class="mono">Historical_Metrics</td>
                                <td>132 √ó 23</td>
                                <td class="mono">349</td>
                                <td>351</td>
                                <td><span class="badge primary">PROCESSING</span></td>
                            </tr>
                            <tr>
                                <td class="mono">MAIC Analytics</td>
                                <td>709 √ó 34</td>
                                <td class="mono">532</td>
                                <td>434</td>
                                <td><span class="badge" style="background: rgba(123,97,255,0.15); color: var(--accent-tertiary);">OUTPUT</span></td>
                            </tr>
                            <tr>
                                <td class="mono">Config</td>
                                <td>166 √ó 32</td>
                                <td class="mono">29</td>
                                <td>336</td>
                                <td><span class="badge warning">CONFIG</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            <!-- Section: Systems Architecture -->
            <section id="section-system-arch" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üî∑ Core Architecture</div>
                    <h1 class="section-title">Systems Architecture</h1>
                    <p class="section-subtitle">High-level architectural overview of the Data Room & Analytics Engine, mapping Excel components to enterprise data platform patterns.</p>
                </div>
                <div class="arch-diagram">
                    <h3 style="text-align: center; margin-bottom: 24px; color: var(--text-primary);">Enterprise Data Platform Architecture (Excel Proxy)</h3>
                    <div class="arch-layer source">
                        <div class="arch-layer-icon">üì•</div>
                        <div class="arch-layer-content">
                            <div class="arch-layer-title">Layer 1: Data Ingestion Layer</div>
                            <div class="arch-layer-desc">External source systems providing raw loan and transaction data</div>
                            <div class="arch-components">
                                <span class="arch-component">Madison Portal Export</span>
                                <span class="arch-component">Rogue Servicer</span>
                                <span class="arch-component">PorchPass Internal</span>
                                <span class="arch-component">17 New Fields</span>
                                <span class="arch-component">P2 Originations</span>
                            </div>
                        </div>
                    </div>
                    <div class="flow-arrow">‚ñº</div>
                    <div class="arch-layer" style="border-left-color: var(--accent-warning);">
                        <div class="arch-layer-icon">‚öôÔ∏è</div>
                        <div class="arch-layer-content">
                            <div class="arch-layer-title">Layer 2: Configuration & Control</div>
                            <div class="arch-layer-desc">Centralized parameters, thresholds, and business rule definitions</div>
                            <div class="arch-components">
                                <span class="arch-component">Config Sheet</span>
                                <span class="arch-component">Report_EOM</span>
                                <span class="arch-component">DPD Thresholds</span>
                                <span class="arch-component">Interest Method</span>
                                <span class="arch-component">Grace Period</span>
                            </div>
                        </div>
                    </div>
                    <div class="flow-arrow">‚ñº</div>
                    <div class="arch-layer process">
                        <div class="arch-layer-icon">üîÑ</div>
                        <div class="arch-layer-content">
                            <div class="arch-layer-title">Layer 3: Processing & Transformation</div>
                            <div class="arch-layer-desc">Core calculation engines performing reconciliation, classification, and aggregation</div>
                            <div class="arch-components">
                                <span class="arch-component">Trial Balance Engine</span>
                                <span class="arch-component">Loan Sale Calculator</span>
                                <span class="arch-component">Historical Aggregator</span>
                                <span class="arch-component">Calendar Analyzer</span>
                            </div>
                        </div>
                    </div>
                    <div class="flow-arrow">‚ñº</div>
                    <div class="arch-layer validate">
                        <div class="arch-layer-icon">‚úÖ</div>
                        <div class="arch-layer-content">
                            <div class="arch-layer-title">Layer 4: Validation & Quality Assurance</div>
                            <div class="arch-layer-desc">Automated data quality checks, exception detection, and flag generation</div>
                            <div class="arch-components">
                                <span class="arch-component">UPB Reconciliation</span>
                                <span class="arch-component">Date Validation</span>
                                <span class="arch-component">Interest Accrual Check</span>
                                <span class="arch-component">Status Matching</span>
                                <span class="arch-component">Payment Completeness</span>
                            </div>
                        </div>
                    </div>
                    <div class="flow-arrow">‚ñº</div>
                    <div class="arch-layer output">
                        <div class="arch-layer-icon">üì§</div>
                        <div class="arch-layer-content">
                            <div class="arch-layer-title">Layer 5: Presentation & Output</div>
                            <div class="arch-layer-desc">Executive dashboards, investor reports, and operational analytics</div>
                            <div class="arch-components">
                                <span class="arch-component">MAIC Analytics</span>
                                <span class="arch-component">Servicing Dashboard</span>
                                <span class="arch-component">QA Dashboard</span>
                                <span class="arch-component">Visual Dashboard</span>
                                <span class="arch-component">Loan Detail Viewer</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h4 style="color: var(--accent-primary); margin-bottom: 16px;">üîë Key Architectural Patterns</h4>
                        <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                            <li><strong style="color: var(--text-primary);">Separation of Concerns:</strong> Config, Source, Processing, Output layers</li>
                            <li><strong style="color: var(--text-primary);">Single Source of Truth:</strong> Config sheet controls all calculations</li>
                            <li><strong style="color: var(--text-primary);">Referential Integrity:</strong> INDEX/MATCH cross-sheet linking</li>
                            <li><strong style="color: var(--text-primary);">Immutable Inputs:</strong> Source sheets preserve raw data</li>
                            <li><strong style="color: var(--text-primary);">Computed Outputs:</strong> All derived values via formulas</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4 style="color: var(--accent-secondary); margin-bottom: 16px;">‚ö° Enterprise Platform Equivalents</h4>
                        <table class="data-table" style="font-size: 0.8rem;">
                            <tr><td>Config Sheet</td><td>‚Üí</td><td class="mono">Parameter Store / Config DB</td></tr>
                            <tr><td>Source Sheets</td><td>‚Üí</td><td class="mono">Data Lake / Raw Zone</td></tr>
                            <tr><td>Trial Balance</td><td>‚Üí</td><td class="mono">ETL / dbt Transformations</td></tr>
                            <tr><td>Historical_Metrics</td><td>‚Üí</td><td class="mono">Data Warehouse / OLAP</td></tr>
                            <tr><td>Dashboards</td><td>‚Üí</td><td class="mono">BI Tools (Tableau/Looker)</td></tr>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Section: Data Flow -->
            <section id="section-data-flow" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üîÄ Data Engineering</div>
                    <h1 class="section-title">Data Flow Pipeline Architecture</h1>
                    <p class="section-subtitle">End-to-end data lifecycle from external sources through validation to final outputs.</p>
                </div>
                <div class="pipeline-container">
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">1</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-secondary);">üì• External Sources</div>
                        <ul class="pipeline-stage-items">
                            <li>Madison Portal CSV export</li>
                            <li>Rogue servicer transaction data</li>
                            <li>PorchPass internal records</li>
                            <li>Supplemental loan attributes</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">2</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-warning);">‚öôÔ∏è Ingestion Layer</div>
                        <ul class="pipeline-stage-items">
                            <li>Raw data paste to source sheets</li>
                            <li>Schema preservation</li>
                            <li>Timestamp tracking</li>
                            <li>Source identification</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">3</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-primary);">üîÑ Processing Engine</div>
                        <ul class="pipeline-stage-items">
                            <li>INDEX/MATCH data linking</li>
                            <li>Transaction aggregation</li>
                            <li>Interest calculations (30/360)</li>
                            <li>DPD computation</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">4</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-warning);">‚úÖ Validation</div>
                        <ul class="pipeline-stage-items">
                            <li>UPB reconciliation</li>
                            <li>Date validation rules</li>
                            <li>Status matching</li>
                            <li>Flag generation</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">5</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-tertiary);">üì§ Output Layer</div>
                        <ul class="pipeline-stage-items">
                            <li>DR Tape generation</li>
                            <li>MAIC reporting</li>
                            <li>Executive dashboards</li>
                            <li>QA exception reports</li>
                        </ul>
                    </div>
                </div>
                <div class="card" style="margin-top: 32px;">
                    <div class="card-header">
                        <div class="card-icon primary">üîó</div>
                        <div>
                            <div class="card-title">Cross-Sheet Reference Patterns</div>
                            <div class="card-subtitle">How data flows between modules via formula linkages</div>
                        </div>
                    </div>
                    <div class="code-block">
<span class="comment">-- Primary data linking pattern (INDEX/MATCH)</span>
<span class="function">=INDEX</span>('Loan Sale Data'!$AB:$AB, <span class="function">MATCH</span>('Trial Balance'!$A2, 'Loan Sale Data'!$A:$A, <span class="number">0</span>))

<span class="comment">-- Transaction aggregation from servicer history</span>
<span class="function">=SUMIFS</span>(Rogue!$L:$L, Rogue!$D:$D, $A2, Rogue!$B:$B, <span class="string">"&lt;="</span>&amp;Config!$D$9)

<span class="comment">-- Period-aware calculations using Config parameters</span>
<span class="function">=IF</span>(H2 &gt; <span class="function">DATE</span>(<span class="number">2025</span>,<span class="number">11</span>,<span class="number">30</span>), <span class="string">""</span>, <span class="function">ROUND</span>(Q2 * (K2/<span class="number">100</span>) / <span class="number">360</span> * AU2, <span class="number">2</span>))
                    </div>
                </div>
                <div class="grid-3" style="margin-top: 24px;">
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 12px;">9,974</div>
                        <div style="color: var(--accent-primary); font-weight: 600; font-size: 0.9rem;">Trial Balance ‚Üí Loan Sale</div>
                        <div style="color: var(--text-muted); font-size: 0.75rem;">Cross-sheet references</div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 12px;">7,960</div>
                        <div style="color: var(--accent-secondary); font-weight: 600; font-size: 0.9rem;">Servicer ‚Üí Processing</div>
                        <div style="color: var(--text-muted); font-size: 0.75rem;">Rogue + PorchPass links</div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 12px;">1,596</div>
                        <div style="color: var(--accent-warning); font-weight: 600; font-size: 0.9rem;">Config ‚Üí Processing</div>
                        <div style="color: var(--text-muted); font-size: 0.75rem;">Parameter references</div>
                    </div>
                </div>
            </section>
            <!-- Section: Components -->
            <section id="section-components" class="content-section">
                <div class="section-header">
                    <div class="section-tag">‚öôÔ∏è Module Catalog</div>
                    <h1 class="section-title">Engine Components</h1>
                    <p class="section-subtitle">Detailed breakdown of all 14 interconnected modules organized by functional layer.</p>
                </div>
                <h3 style="color: var(--accent-secondary); margin-bottom: 16px; font-size: 1rem;">üì• Source Data Layer</h3>
                <div class="sheet-grid" style="margin-bottom: 32px;">
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ Rogue</span>
                            <span class="sheet-card-layer source">SOURCE</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">3,274</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Columns</span><span class="sheet-stat-value">17</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">13,068</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Consumers</span><span class="sheet-stat-value">5</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Servicer transaction history with payment aggregation formulas</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ PorchPass</span>
                            <span class="sheet-card-layer source">SOURCE</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">2,768</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Columns</span><span class="sheet-stat-value">17</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">6,811</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Consumers</span><span class="sheet-stat-value">5</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Internal collections data matching Rogue structure</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ P2 Originated</span>
                            <span class="sheet-card-layer source">SOURCE</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">399</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Columns</span><span class="sheet-stat-value">76</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">797</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Consumers</span><span class="sheet-stat-value">1</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Master loan origination data with 76 attributes</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ 17 New Fields</span>
                            <span class="sheet-card-layer source">SOURCE</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">399</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Columns</span><span class="sheet-stat-value">41</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">0</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Consumers</span><span class="sheet-stat-value">2</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Supplemental: Bank Purchaser, Dealer, Fees</div>
                    </div>
                </div>
                <h3 style="color: var(--accent-primary); margin-bottom: 16px; font-size: 1rem;">üîÑ Processing Layer</h3>
                <div class="sheet-grid" style="margin-bottom: 32px;">
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ Trial Balance</span>
                            <span class="sheet-card-layer process">PROCESS</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">400</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Columns</span><span class="sheet-stat-value">68</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">22,742</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Consumers</span><span class="sheet-stat-value">4</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Core validation engine: UPB, DPD, status, flags</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ Loan Sale Data</span>
                            <span class="sheet-card-layer process">PROCESS</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">432</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Columns</span><span class="sheet-stat-value">74</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">14,334</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Consumers</span><span class="sheet-stat-value">5</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">DR Tape generator: 64 output fields per loan</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ Historical_Metrics</span>
                            <span class="sheet-card-layer process">PROCESS</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">132</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Columns</span><span class="sheet-stat-value">23</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">349</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Consumers</span><span class="sheet-stat-value">2</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Data warehouse proxy: 12-month trend aggregations</div>
                    </div>
                </div>
                <h3 style="color: var(--accent-tertiary); margin-bottom: 16px; font-size: 1rem;">üì§ Output & Presentation Layer</h3>
                <div class="sheet-grid">
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ MAIC Analytics</span>
                            <span class="sheet-card-layer output">OUTPUT</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">709</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">532</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Investor reporting analytics</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ Servicing Dashboard</span>
                            <span class="sheet-card-layer output">OUTPUT</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">833</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">171</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Executive KPIs & MoM performance</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ QA Dashboard</span>
                            <span class="sheet-card-layer output">OUTPUT</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">930</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">145</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Exception management & flags</div>
                    </div>
                    <div class="sheet-card">
                        <div class="sheet-card-header">
                            <span class="sheet-card-name">üìÑ Loan Detail Viewer</span>
                            <span class="sheet-card-layer output">OUTPUT</span>
                        </div>
                        <div class="sheet-card-stats">
                            <div class="sheet-stat"><span class="sheet-stat-label">Rows</span><span class="sheet-stat-value">125</span></div>
                            <div class="sheet-stat"><span class="sheet-stat-label">Formulas</span><span class="sheet-stat-value">1,100</span></div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Single-loan deep dive viewer</div>
                    </div>
                </div>
            </section>

            <!-- Section: Data Lineage -->
            <section id="section-lineage" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üîó Data Governance</div>
                    <h1 class="section-title">Data Lineage & Dependencies</h1>
                    <p class="section-subtitle">Complete mapping of how data flows between modules, enabling impact analysis and change management.</p>
                </div>
                <div class="dep-diagram">
                    <h3 style="text-align: center; margin-bottom: 32px;">Data Dependency Graph</h3>
                    <div class="dep-layer">
                        <div class="dep-node source" style="min-width: 120px;">Config<br><span style="font-size: 0.65rem; color: var(--text-muted);">6 consumers</span></div>
                    </div>
                    <div class="dep-connector">‚Üì ‚Üì ‚Üì</div>
                    <div class="dep-layer">
                        <div class="dep-node source">Rogue<br><span style="font-size: 0.65rem; color: var(--text-muted);">5 consumers</span></div>
                        <div class="dep-node source">PorchPass<br><span style="font-size: 0.65rem; color: var(--text-muted);">5 consumers</span></div>
                        <div class="dep-node source">17 New Fields<br><span style="font-size: 0.65rem; color: var(--text-muted);">2 consumers</span></div>
                        <div class="dep-node source">P2 Originated<br><span style="font-size: 0.65rem; color: var(--text-muted);">1 consumer</span></div>
                    </div>
                    <div class="dep-connector">‚Üì ‚Üì ‚Üì ‚Üì</div>
                    <div class="dep-layer">
                        <div class="dep-node process" style="min-width: 200px;">Loan Sale Data<br><span style="font-size: 0.65rem; color: var(--text-muted);">14,334 formulas</span></div>
                        <div class="dep-node process" style="min-width: 200px;">Trial Balance<br><span style="font-size: 0.65rem; color: var(--text-muted);">22,742 formulas</span></div>
                    </div>
                    <div class="dep-connector">‚Üì ‚Üì</div>
                    <div class="dep-layer">
                        <div class="dep-node process">Historical_Metrics</div>
                        <div class="dep-node process">Calendar Analysis</div>
                    </div>
                    <div class="dep-connector">‚Üì ‚Üì ‚Üì ‚Üì</div>
                    <div class="dep-layer">
                        <div class="dep-node output">MAIC Analytics</div>
                        <div class="dep-node output">Servicing Dashboard</div>
                        <div class="dep-node output">QA Dashboard</div>
                        <div class="dep-node output">Visual Dashboard</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon primary">üìä</div>
                        <div>
                            <div class="card-title">Cross-Sheet Reference Statistics</div>
                            <div class="card-subtitle">Formula linkages between modules</div>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr><th>Source Module</th><th>Target Module</th><th>Reference Count</th><th>Relationship</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="mono">Loan Sale Data</td><td class="mono">Trial Balance</td><td class="mono" style="color: var(--accent-primary);">9,974</td><td>Primary data linkage</td></tr>
                            <tr><td class="mono">Rogue</td><td class="mono">Loan Sale Data</td><td class="mono" style="color: var(--accent-primary);">3,980</td><td>Transaction aggregation</td></tr>
                            <tr><td class="mono">PorchPass</td><td class="mono">Loan Sale Data</td><td class="mono" style="color: var(--accent-primary);">3,980</td><td>Transaction aggregation</td></tr>
                            <tr><td class="mono">Config</td><td class="mono">Trial Balance</td><td class="mono">1,596</td><td>Parameter injection</td></tr>
                            <tr><td class="mono">Historical_Metrics</td><td class="mono">Visual_Dashboard</td><td class="mono">99</td><td>Chart data source</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>
            <!-- Section: ERD -->
            <section id="section-erd" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üìê Data Modeling</div>
                    <h1 class="section-title">Entity Relationship Diagram</h1>
                    <p class="section-subtitle">Logical data model representing the core entities, their attributes, and relationships within the system.</p>
                </div>
                <div class="erd-container">
                    <div class="erd-entity">
                        <div class="erd-entity-header source">üìÑ LOAN (Master)</div>
                        <div class="erd-entity-body">
                            <div class="erd-field"><span class="erd-field-icon">üîë</span><span class="erd-field-name">porchpass_id</span><span class="erd-field-type">PK, VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üîó</span><span class="erd-field-name">madison_account_#</span><span class="erd-field-type">FK, VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">borrower_name</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">origination_date</span><span class="erd-field-type">DATE</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">original_loan_balance</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">interest_rate</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">loan_term_months</span><span class="erd-field-type">INT</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">maturity_date</span><span class="erd-field-type">DATE</span></div>
                        </div>
                    </div>
                    <div class="erd-entity">
                        <div class="erd-entity-header process">üí≥ TRANSACTION</div>
                        <div class="erd-entity-body">
                            <div class="erd-field"><span class="erd-field-icon">üîë</span><span class="erd-field-name">transaction_id</span><span class="erd-field-type">PK, SERIAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üîó</span><span class="erd-field-name">porchpass_id</span><span class="erd-field-type">FK, VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">transaction_date</span><span class="erd-field-type">DATE</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">principal_amount</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">interest_amount</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">late_fee</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">source_system</span><span class="erd-field-type">VARCHAR</span></div>
                        </div>
                    </div>
                    <div class="erd-entity">
                        <div class="erd-entity-header process">üìä MONTHLY_SNAPSHOT</div>
                        <div class="erd-entity-body">
                            <div class="erd-field"><span class="erd-field-icon">üîë</span><span class="erd-field-name">snapshot_id</span><span class="erd-field-type">PK, SERIAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üîó</span><span class="erd-field-name">porchpass_id</span><span class="erd-field-type">FK, VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">report_eom</span><span class="erd-field-type">DATE</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">beginning_balance</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">ending_balance</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">days_past_due</span><span class="erd-field-type">INT</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">loan_status</span><span class="erd-field-type">VARCHAR</span></div>
                        </div>
                    </div>
                    <div class="erd-entity">
                        <div class="erd-entity-header output">üö© VALIDATION_FLAG</div>
                        <div class="erd-entity-body">
                            <div class="erd-field"><span class="erd-field-icon">üîë</span><span class="erd-field-name">flag_id</span><span class="erd-field-type">PK, SERIAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üîó</span><span class="erd-field-name">snapshot_id</span><span class="erd-field-type">FK, INT</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">flag_type</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">flag_message</span><span class="erd-field-type">TEXT</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">severity</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">resolution_status</span><span class="erd-field-type">VARCHAR</span></div>
                        </div>
                    </div>
                    <div class="erd-entity">
                        <div class="erd-entity-header source">üè† PROPERTY</div>
                        <div class="erd-entity-body">
                            <div class="erd-field"><span class="erd-field-icon">üîë</span><span class="erd-field-name">property_id</span><span class="erd-field-type">PK, SERIAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üîó</span><span class="erd-field-name">porchpass_id</span><span class="erd-field-type">FK, VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">property_address</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">property_city</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">property_state</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">property_value</span><span class="erd-field-type">DECIMAL</span></div>
                        </div>
                    </div>
                    <div class="erd-entity">
                        <div class="erd-entity-header output">üìà HISTORICAL_METRIC</div>
                        <div class="erd-entity-body">
                            <div class="erd-field"><span class="erd-field-icon">üîë</span><span class="erd-field-name">metric_id</span><span class="erd-field-type">PK, SERIAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">report_period</span><span class="erd-field-type">DATE</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">metric_name</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">metric_value</span><span class="erd-field-type">DECIMAL</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">loan_status</span><span class="erd-field-type">VARCHAR</span></div>
                            <div class="erd-field"><span class="erd-field-icon">üìù</span><span class="erd-field-name">aggregation_type</span><span class="erd-field-type">VARCHAR</span></div>
                        </div>
                    </div>
                </div>
                <div class="card" style="margin-top: 24px;">
                    <h4 style="color: var(--accent-primary); margin-bottom: 16px;">üîó Key Relationships</h4>
                    <div class="grid-2">
                        <div><code style="color: var(--text-code);">LOAN</code> 1:N <code style="color: var(--text-code);">TRANSACTION</code><p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 4px;">Each loan has many transactions</p></div>
                        <div><code style="color: var(--text-code);">LOAN</code> 1:N <code style="color: var(--text-code);">MONTHLY_SNAPSHOT</code><p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 4px;">Monthly DR Tape records per loan</p></div>
                        <div><code style="color: var(--text-code);">MONTHLY_SNAPSHOT</code> 1:N <code style="color: var(--text-code);">VALIDATION_FLAG</code><p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 4px;">Flags generated per snapshot</p></div>
                        <div><code style="color: var(--text-code);">LOAN</code> 1:1 <code style="color: var(--text-code);">PROPERTY</code><p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 4px;">Collateral property details</p></div>
                    </div>
                </div>
            </section>

            <!-- Section: Validation Pipeline -->
            <section id="section-validation" class="content-section">
                <div class="section-header">
                    <div class="section-tag">‚úÖ Data Quality</div>
                    <h1 class="section-title">Validation Pipeline Architecture</h1>
                    <p class="section-subtitle">Comprehensive data quality, control, and assurance framework with automated flag generation.</p>
                </div>
                <div class="pipeline-container">
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">1</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-secondary);">Data Ingestion</div>
                        <ul class="pipeline-stage-items">
                            <li>Prior month DR Tape</li>
                            <li>Madison export import</li>
                            <li>Servicer transaction load</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">2</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-warning);">Pre-Flight Checks</div>
                        <ul class="pipeline-stage-items">
                            <li>Schema validation</li>
                            <li>Referential integrity</li>
                            <li>Range validations</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">3</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-primary);">Business Rules</div>
                        <ul class="pipeline-stage-items">
                            <li>UPB reconciliation</li>
                            <li>Interest calculations</li>
                            <li>Status determination</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">4</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-danger);">Exception Flags</div>
                        <ul class="pipeline-stage-items">
                            <li>UPB_MISMATCH</li>
                            <li>BAD_DUE_DATE</li>
                            <li>STATUS_MISMATCH</li>
                        </ul>
                    </div>
                    <div class="pipeline-stage">
                        <span class="pipeline-stage-num">5</span>
                        <div class="pipeline-stage-title" style="color: var(--accent-success);">Validated Output</div>
                        <ul class="pipeline-stage-items">
                            <li>Clean DR Tape data</li>
                            <li>Flag summary reports</li>
                            <li>QA dashboards</li>
                        </ul>
                    </div>
                </div>
                <div class="card" style="margin-top: 24px;">
                    <div class="card-header">
                        <div class="card-icon warning">üìã</div>
                        <div>
                            <div class="card-title">Validation Rules Catalog</div>
                            <div class="card-subtitle">Complete inventory of automated validation checks</div>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr><th>Validation Rule</th><th>Logic</th><th>Flag If</th><th>Action Required</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><span class="badge primary">UPB Reconciliation</span></td><td>End UPB = Beg UPB - Principal</td><td class="mono">|Diff| &gt; $0.01</td><td>Check Madison for curtailments</td></tr>
                            <tr><td><span class="badge primary">Due Date Validation</span></td><td>Payment Due must be 1st or 15th</td><td class="mono">Day ‚â† 1 or 15</td><td>Check Madison, correct dates</td></tr>
                            <tr><td><span class="badge primary">Interest Accrual</span></td><td>AUTO vs MANUAL interest</td><td class="mono">|Diff| &gt; $1.00</td><td>Recalculate 30/360</td></tr>
                            <tr><td><span class="badge warning">Loan Status Match</span></td><td>AUTO vs MANUAL status</td><td class="mono">Statuses ‚â†</td><td>Review DPD calculation</td></tr>
                            <tr><td><span class="badge warning">Payment Completeness</span></td><td>Actual vs Expected payment</td><td class="mono">Diff exists</td><td>Check escrow/partial</td></tr>
                            <tr><td><span class="badge info">BOM vs Prior EOM</span></td><td>Beg UPB = Prior End UPB</td><td class="mono">|Diff| &gt; $0.01</td><td>Investigate changes</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>
            <!-- Section: Business Rules -->
            <section id="section-business-rules" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üìã Business Logic</div>
                    <h1 class="section-title">Business Rules Engine</h1>
                    <p class="section-subtitle">Complete documentation of servicing business rules, calculations, and status determination logic.</p>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon primary">üìä</div>
                            <div><div class="card-title">Loan Status Classification</div><div class="card-subtitle">Rule-based status determination</div></div>
                        </div>
                        <table class="data-table">
                            <tr><td><span class="badge success">Performing</span></td><td>DPD 0-29 days</td></tr>
                            <tr><td><span class="badge warning">Collections</span></td><td>DPD 30-59 days</td></tr>
                            <tr><td><span class="badge" style="background: rgba(255,90,90,0.15); color: var(--accent-danger);">DQ60+</span></td><td>DPD 60+ days</td></tr>
                            <tr><td><span class="badge info">Paid Off</span></td><td>UPB = $0</td></tr>
                        </table>
                        <div class="code-block" style="margin-top: 16px; font-size: 0.7rem;">
<span class="comment">-- Status Determination Logic</span>
<span class="function">=IF</span>(UPB=<span class="number">0</span>, <span class="string">"Paid Off"</span>,
  <span class="function">IF</span>(<span class="function">AND</span>(UPB&gt;<span class="number">0</span>, DPD&gt;=<span class="number">0</span>, DPD&lt;=<span class="number">29</span>), <span class="string">"Performing"</span>,
    <span class="function">IF</span>(<span class="function">AND</span>(UPB&gt;<span class="number">0</span>, DPD&gt;=<span class="number">30</span>, DPD&lt;=<span class="number">59</span>), <span class="string">"Collections"</span>,
      <span class="function">IF</span>(<span class="function">AND</span>(UPB&gt;<span class="number">0</span>, DPD&gt;=<span class="number">60</span>), <span class="string">"dq60+"</span>, <span class="string">""</span>))))
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon secondary">üí∞</div>
                            <div><div class="card-title">Interest Calculation (30/360)</div><div class="card-subtitle">Standard accrual methodology</div></div>
                        </div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8;">
                            <p><strong style="color: var(--text-primary);">Method:</strong> 30/360 day count convention</p>
                            <p><strong style="color: var(--text-primary);">Formula:</strong> Interest = Principal √ó (Rate/100) / 360 √ó Days</p>
                            <p><strong style="color: var(--text-primary);">Accrual Days:</strong> Based on last payment due date</p>
                        </div>
                        <div class="code-block" style="margin-top: 16px; font-size: 0.7rem;">
<span class="comment">-- Interest Accrual Calculation</span>
<span class="function">=IF</span>(Accrual_Days=<span class="number">0</span>, <span class="number">0</span>,
  <span class="function">IF</span>(<span class="function">DAY</span>(Last_Pmt_Due)=<span class="number">15</span>,
    <span class="function">ROUND</span>(End_UPB * Rate / <span class="number">360</span> * Days, <span class="number">2</span>),
    <span class="function">ROUND</span>(Beg_UPB * Rate / <span class="number">360</span> * Days, <span class="number">2</span>)))
                        </div>
                    </div>
                </div>
                <div class="card" style="margin-top: 24px;">
                    <div class="card-header">
                        <div class="card-icon warning">‚öôÔ∏è</div>
                        <div><div class="card-title">Configuration Parameters</div><div class="card-subtitle">Centralized business rule thresholds</div></div>
                    </div>
                    <table class="data-table">
                        <thead><tr><th>Parameter</th><th>Value</th><th>Type</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td class="mono">Report_Month</td><td>November</td><td>Text</td><td>Current reporting period</td></tr>
                            <tr><td class="mono">Report_Year</td><td>2025</td><td>Number</td><td>Reporting year</td></tr>
                            <tr><td class="mono">Report_EOM</td><td>2025-11-30</td><td>Date</td><td>End of month for calculations</td></tr>
                            <tr><td class="mono">Grace_Period_Days</td><td>14</td><td>Number</td><td>Days before late fee</td></tr>
                            <tr><td class="mono">Collections_Threshold</td><td>30</td><td>Number</td><td>DPD for Collections status</td></tr>
                            <tr><td class="mono">DQ60_Threshold</td><td>60</td><td>Number</td><td>DPD for DQ60+ status</td></tr>
                            <tr><td class="mono">Interest_Calc_Method</td><td>30/360</td><td>Text</td><td>Interest convention</td></tr>
                            <tr><td class="mono">Valid_Due_Days</td><td>1, 15</td><td>Text</td><td>Valid payment due days</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section: SQL Proxy -->
            <section id="section-sql-proxy" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üóÑÔ∏è Database Blueprint</div>
                    <h1 class="section-title">SQL Schema Proxy</h1>
                    <p class="section-subtitle">Database-ready schema definitions derived from the Excel structure for enterprise migration.</p>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon primary">üìã</div>
                        <div><div class="card-title">Core Tables DDL</div><div class="card-subtitle">PostgreSQL schema definitions</div></div>
                    </div>
                    <div class="code-block">
<span class="comment">-- ============================================</span>
<span class="comment">-- P2 DATA ROOM - DATABASE SCHEMA</span>
<span class="comment">-- ============================================</span>

<span class="keyword">CREATE TABLE</span> <span class="function">loans</span> (
    porchpass_id        <span class="string">VARCHAR(50)</span> <span class="keyword">PRIMARY KEY</span>,
    madison_account_num <span class="string">VARCHAR(50)</span>,
    borrower_name       <span class="string">VARCHAR(200)</span>,
    origination_date    <span class="string">DATE</span>,
    original_balance    <span class="string">DECIMAL(12,2)</span>,
    interest_rate       <span class="string">DECIMAL(5,4)</span>,
    loan_term           <span class="string">INTEGER</span>,
    maturity_date       <span class="string">DATE</span>
);

<span class="keyword">CREATE TABLE</span> <span class="function">transactions</span> (
    transaction_id      <span class="string">SERIAL</span> <span class="keyword">PRIMARY KEY</span>,
    porchpass_id        <span class="string">VARCHAR(50)</span> <span class="keyword">REFERENCES</span> loans(porchpass_id),
    transaction_date    <span class="string">DATE</span> <span class="keyword">NOT NULL</span>,
    principal_amount    <span class="string">DECIMAL(10,2)</span>,
    interest_amount     <span class="string">DECIMAL(10,2)</span>,
    source_system       <span class="string">VARCHAR(50)</span>
);

<span class="keyword">CREATE TABLE</span> <span class="function">monthly_snapshots</span> (
    snapshot_id         <span class="string">SERIAL</span> <span class="keyword">PRIMARY KEY</span>,
    porchpass_id        <span class="string">VARCHAR(50)</span> <span class="keyword">REFERENCES</span> loans(porchpass_id),
    report_eom          <span class="string">DATE</span> <span class="keyword">NOT NULL</span>,
    beginning_balance   <span class="string">DECIMAL(12,2)</span>,
    ending_balance      <span class="string">DECIMAL(12,2)</span>,
    days_past_due       <span class="string">INTEGER</span>,
    loan_status         <span class="string">VARCHAR(50)</span>,
    <span class="keyword">UNIQUE</span>(porchpass_id, report_eom)
);
                    </div>
                </div>
                <div class="grid-2" style="margin-top: 24px;">
                    <div class="card">
                        <h4 style="color: var(--accent-primary); margin-bottom: 12px;">üìä Excel ‚Üí SQL Mapping</h4>
                        <table class="data-table" style="font-size: 0.75rem;">
                            <tr><td>INDEX/MATCH</td><td>‚Üí</td><td class="mono">JOIN + WHERE</td></tr>
                            <tr><td>SUMIFS</td><td>‚Üí</td><td class="mono">SUM() + GROUP BY</td></tr>
                            <tr><td>COUNTIFS</td><td>‚Üí</td><td class="mono">COUNT() + FILTER</td></tr>
                            <tr><td>IFERROR</td><td>‚Üí</td><td class="mono">COALESCE / NULLIF</td></tr>
                            <tr><td>IFS</td><td>‚Üí</td><td class="mono">CASE WHEN</td></tr>
                        </table>
                    </div>
                    <div class="card">
                        <h4 style="color: var(--accent-secondary); margin-bottom: 12px;">üóÇÔ∏è Table Counts</h4>
                        <table class="data-table" style="font-size: 0.75rem;">
                            <tr><td class="mono">loans</td><td>~398 rows</td><td>Master data</td></tr>
                            <tr><td class="mono">transactions</td><td>~6,000 rows</td><td>Payment history</td></tr>
                            <tr><td class="mono">monthly_snapshots</td><td>~4,800 rows</td><td>12 months √ó 400</td></tr>
                            <tr><td class="mono">validation_flags</td><td>~200 rows</td><td>Exceptions</td></tr>
                        </table>
                    </div>
                </div>
            </section>
            <!-- Section: Blueprint -->
            <section id="section-blueprint" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üöÄ Future State</div>
                    <h1 class="section-title">Enterprise Blueprint</h1>
                    <p class="section-subtitle">Comprehensive migration roadmap from Excel-based system to enterprise data platform.</p>
                </div>
                <div class="grid-2">
                    <div class="card" style="border: 2px solid var(--accent-warning);">
                        <h3 style="color: var(--accent-warning); margin-bottom: 20px;">üìä Current State (Excel)</h3>
                        <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                            <li>‚úì 14 interconnected worksheets</li>
                            <li>‚úì 60,481 formula calculations</li>
                            <li>‚úì Manual data ingestion (copy/paste)</li>
                            <li>‚úì Single-file architecture</li>
                            <li>‚úì Local execution only</li>
                            <li>‚úì Limited concurrent access</li>
                            <li>‚úì Manual backup/versioning</li>
                        </ul>
                        <div style="margin-top: 20px; padding: 16px; background: rgba(255,183,3,0.1); border-radius: 10px;">
                            <div style="font-weight: 600; margin-bottom: 8px;">Limitations</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Scales to ~5,000 loans before performance degrades. No real-time updates.</div>
                        </div>
                    </div>
                    <div class="card" style="border: 2px solid var(--accent-primary);">
                        <h3 style="color: var(--accent-primary); margin-bottom: 20px;">üöÄ Target State (Enterprise)</h3>
                        <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                            <li>‚Üí PostgreSQL + Data Warehouse</li>
                            <li>‚Üí dbt transformations</li>
                            <li>‚Üí Automated ETL pipelines</li>
                            <li>‚Üí Microservices architecture</li>
                            <li>‚Üí Cloud-native deployment</li>
                            <li>‚Üí Multi-user concurrent access</li>
                            <li>‚Üí REST/GraphQL API layer</li>
                        </ul>
                        <div style="margin-top: 20px; padding: 16px; background: rgba(0,212,170,0.1); border-radius: 10px;">
                            <div style="font-weight: 600; margin-bottom: 8px;">Capabilities</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">Scales to 100,000+ loans. Real-time data. Automated scheduling.</div>
                        </div>
                    </div>
                </div>
                <div class="card" style="margin-top: 24px;">
                    <div class="card-header">
                        <div class="card-icon tertiary">üó∫Ô∏è</div>
                        <div><div class="card-title">Migration Roadmap</div><div class="card-subtitle">Phased transition from Excel to enterprise platform</div></div>
                    </div>
                    <div class="pipeline-container">
                        <div class="pipeline-stage" style="min-width: 180px;">
                            <span class="pipeline-stage-num">1</span>
                            <div class="pipeline-stage-title">Q1 2026</div>
                            <ul class="pipeline-stage-items">
                                <li>Schema migration to PostgreSQL</li>
                                <li>Initial data load scripts</li>
                                <li>Excel ‚Üí DB validation</li>
                            </ul>
                        </div>
                        <div class="pipeline-stage" style="min-width: 180px;">
                            <span class="pipeline-stage-num">2</span>
                            <div class="pipeline-stage-title">Q2 2026</div>
                            <ul class="pipeline-stage-items">
                                <li>dbt transformation layer</li>
                                <li>Automated ETL pipelines</li>
                                <li>Data warehouse setup</li>
                            </ul>
                        </div>
                        <div class="pipeline-stage" style="min-width: 180px;">
                            <span class="pipeline-stage-num">3</span>
                            <div class="pipeline-stage-title">Q3 2026</div>
                            <ul class="pipeline-stage-items">
                                <li>BI dashboard migration</li>
                                <li>API development</li>
                                <li>User acceptance testing</li>
                            </ul>
                        </div>
                        <div class="pipeline-stage" style="min-width: 180px;">
                            <span class="pipeline-stage-num">4</span>
                            <div class="pipeline-stage-title">Q4 2026</div>
                            <ul class="pipeline-stage-items">
                                <li>Production cutover</li>
                                <li>Excel deprecation</li>
                                <li>Documentation complete</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="grid-3" style="margin-top: 24px;">
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 12px;">‚ö°</div>
                        <div style="font-weight: 600;">10x Performance</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 8px;">Sub-second queries vs. minutes</div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 12px;">üîÑ</div>
                        <div style="font-weight: 600;">Real-Time Sync</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 8px;">Madison API integration</div>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 12px;">üìà</div>
                        <div style="font-weight: 600;">Unlimited Scale</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 8px;">100,000+ loans</div>
                    </div>
                </div>
            </section>

            <!-- Section: Value Stream -->
            <section id="section-value-stream" class="content-section">
                <div class="section-header">
                    <div class="section-tag">üìà Process Analysis</div>
                    <h1 class="section-title">Value Stream Map</h1>
                    <p class="section-subtitle">End-to-end process flow comparing current and future state operations.</p>
                </div>
                <div class="card" style="margin-bottom: 24px;">
                    <h3 style="color: var(--accent-warning); margin-bottom: 20px;">üìä Current State Value Stream</h3>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                        <div style="background: var(--bg-secondary); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px;">
                            <div style="font-size: 0.7rem; color: var(--text-muted);">Madison Export</div>
                            <div style="font-weight: 600; margin-top: 4px;">15 min</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: var(--bg-secondary); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px;">
                            <div style="font-size: 0.7rem; color: var(--text-muted);">Copy to Excel</div>
                            <div style="font-weight: 600; margin-top: 4px;">10 min</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: var(--bg-secondary); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px;">
                            <div style="font-size: 0.7rem; color: var(--text-muted);">Formula Calc</div>
                            <div style="font-weight: 600; margin-top: 4px;">2-3 min</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: var(--bg-secondary); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px;">
                            <div style="font-size: 0.7rem; color: var(--text-muted);">QA Review</div>
                            <div style="font-weight: 600; margin-top: 4px;">30-60 min</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: var(--bg-secondary); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px;">
                            <div style="font-size: 0.7rem; color: var(--text-muted);">Report Gen</div>
                            <div style="font-weight: 600; margin-top: 4px;">15 min</div>
                        </div>
                    </div>
                    <div style="margin-top: 16px; padding: 12px; background: rgba(255,183,3,0.1); border-radius: 8px; display: flex; justify-content: space-between;">
                        <span>Total Lead Time:</span>
                        <span style="font-weight: 700; color: var(--accent-warning);">~90-120 minutes</span>
                    </div>
                </div>
                <div class="card">
                    <h3 style="color: var(--accent-primary); margin-bottom: 20px;">üöÄ Future State Value Stream</h3>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                        <div style="background: rgba(0,212,170,0.1); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px; border: 1px solid rgba(0,212,170,0.3);">
                            <div style="font-size: 0.7rem; color: var(--accent-primary);">API Sync</div>
                            <div style="font-weight: 600; margin-top: 4px; color: var(--accent-primary);">Automated</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: rgba(0,212,170,0.1); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px; border: 1px solid rgba(0,212,170,0.3);">
                            <div style="font-size: 0.7rem; color: var(--accent-primary);">ETL Pipeline</div>
                            <div style="font-weight: 600; margin-top: 4px; color: var(--accent-primary);">&lt;1 min</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: rgba(0,212,170,0.1); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px; border: 1px solid rgba(0,212,170,0.3);">
                            <div style="font-size: 0.7rem; color: var(--accent-primary);">dbt Transform</div>
                            <div style="font-weight: 600; margin-top: 4px; color: var(--accent-primary);">&lt;30 sec</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: rgba(0,212,170,0.1); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px; border: 1px solid rgba(0,212,170,0.3);">
                            <div style="font-size: 0.7rem; color: var(--accent-primary);">Auto-QA</div>
                            <div style="font-weight: 600; margin-top: 4px; color: var(--accent-primary);">&lt;30 sec</div>
                        </div>
                        <div style="color: var(--text-muted);">‚Üí</div>
                        <div style="background: rgba(0,212,170,0.1); padding: 16px; border-radius: 10px; text-align: center; min-width: 120px; border: 1px solid rgba(0,212,170,0.3);">
                            <div style="font-size: 0.7rem; color: var(--accent-primary);">Dashboard</div>
                            <div style="font-weight: 600; margin-top: 4px; color: var(--accent-primary);">Real-time</div>
                        </div>
                    </div>
                    <div style="margin-top: 16px; padding: 12px; background: rgba(0,212,170,0.1); border-radius: 8px; display: flex; justify-content: space-between;">
                        <span>Total Lead Time:</span>
                        <span style="font-weight: 700; color: var(--accent-primary);">~2-3 minutes (automated)</span>
                    </div>
                </div>
                <div class="grid-4" style="margin-top: 24px;">
                    <div class="metric-card">
                        <div class="metric-value">97%</div>
                        <div class="metric-label">Time Reduction</div>
                        <div class="metric-sublabel">90 min ‚Üí 3 min</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">100%</div>
                        <div class="metric-label">Automation</div>
                        <div class="metric-sublabel">No Manual Steps</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">Real-Time</div>
                        <div class="metric-label">Data Freshness</div>
                        <div class="metric-sublabel">vs. Monthly Batch</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">$210K+</div>
                        <div class="metric-label">Annual Savings</div>
                        <div class="metric-sublabel">Cost Avoidance</div>
                    </div>
                </div>
                <div class="card" style="margin-top: 24px; border: 2px solid var(--accent-tertiary);">
                    <h3 style="color: var(--accent-tertiary); margin-bottom: 20px;">üíé Key Value Delivered</h3>
                    <div class="grid-2">
                        <div>
                            <h4 style="font-size: 0.9rem; margin-bottom: 12px;">Technical Achievements</h4>
                            <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                                <li>‚úì <strong>154,307</strong> total data points managed</li>
                                <li>‚úì <strong>60,481</strong> automated calculations</li>
                                <li>‚úì <strong>12 months</strong> historical coverage</li>
                                <li>‚úì <strong>&lt;72 hours</strong> system build time</li>
                                <li>‚úì <strong>&lt;5 minutes</strong> monthly execution</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="font-size: 0.9rem; margin-bottom: 12px;">Business Impact</h4>
                            <ul style="list-style: none; font-size: 0.85rem; color: var(--text-secondary); line-height: 2;">
                                <li>‚úì <strong>$210K+</strong> annual cost avoidance</li>
                                <li>‚úì Eliminated manual calculation errors</li>
                                <li>‚úì Real-time delinquency visibility</li>
                                <li>‚úì Board-ready investor reports</li>
                                <li>‚úì Scalable to 10,000+ loans</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="card" style="margin-top: 24px; text-align: center; padding: 40px;">
                    <div style="font-size: 1.5rem; margin-bottom: 16px;">üèÜ</div>
                    <h3 style="font-size: 1.3rem; margin-bottom: 12px;">System Summary</h3>
                    <p style="color: var(--text-secondary); max-width: 700px; margin: 0 auto; line-height: 1.8;">
                        This Data Room & Analytics Engine represents an enterprise-grade loan portfolio analytics 
                        infrastructure built in Excel. It serves as both a fully functional production system 
                        and a complete architectural blueprint for future database and data warehouse migration.
                    </p>
                    <div style="display: flex; justify-content: center; gap: 16px; margin-top: 24px; flex-wrap: wrap;">
                        <span class="badge success" style="font-size: 0.8rem; padding: 8px 20px;">PRODUCTION READY</span>
                        <span class="badge info" style="font-size: 0.8rem; padding: 8px 20px;">MIGRATION BLUEPRINT</span>
                        <span class="badge primary" style="font-size: 0.8rem; padding: 8px 20px;">SCALABLE</span>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <script>
        function showSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => { section.classList.remove('active'); });
            document.querySelectorAll('.nav-item').forEach(item => { item.classList.remove('active'); });
            document.getElementById('section-' + sectionId).classList.add('active');
            event.currentTarget.classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        document.addEventListener('DOMContentLoaded', function() {
            console.log('P2 DataRoom Technical Architecture loaded');
        });
    </script>
</body>
</html>
